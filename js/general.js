var lastFocusFieldId="";var minimumPasswordStrength=3;var userTimeoutIntervalTimer=null;var gDefaultAjaxTimeout=30000;var logJavascriptErrors=false;$(function(){$(document).on("click","#_login_popup_dialog a#access_link",function(){if($().validationEngine){$("#_login_edit_form").validationEngine("hideAll")}$("#_login_popup_dialog").data("forgot_form",true);$("#_login_popup_dialog #login_form").slideUp();$("#_login_popup_dialog #access_link_div").slideUp();$("#_login_popup_dialog #forgot_form").slideDown();$("#_login_popup_dialog #forgot_user_name").focus();$("#_login_popup_dialog_button").html("Submit");return false});$(document).on("click",".login-popup-link",function(){showLoginPopup();return false})});$(function(){$(document).on("tap click",".track-click",function(){let clickDescription=$(this).data("click_name");if(empty(clickDescription)){clickDescription=$(this).attr("id")}if(empty(clickDescription)){return}$("body").addClass("no-waiting-for-ajax");$.ajax({url:"/index.php?ajax=true&url_action=log_click",type:"POST",data:{description:clickDescription},timeout:(empty(gDefaultAjaxTimeout)?30000:gDefaultAjaxTimeout),success:function(d){var e=processReturn(d);if(e===false){return}},error:function(d,f,e){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax")},dataType:"text"})});if($("#onload_website_popup").length>0){if(empty($.cookie("onload_website_popup"))){setTimeout(function(){showOnloadWebsitePopup()},500)}}$.ajaxSetup({cache:false});if($(".modal").length==0){$("body").append('<div class="modal"><span class="far fa-spinner fa-spin"></span></div>')}window.onerror=function(g,f,j,e,d){if(logJavascriptErrors){var h=d.stack;if(j>0){$.ajax({url:"logjavascripterror.php?ajax=true",type:"POST",data:{message:g,url:f,line_no:j,script_filename:scriptFilename,error_source:h},timeout:(empty(gDefaultAjaxTimeout)?30000:gDefaultAjaxTimeout),dataType:"text"})}}};$(document).on("click",".jump-link",function(){const d=$(this).data("element_id");if(!empty(d)&&$("#"+d).length>0){$("html,body").animate({scrollTop:$("#"+d).offset().top})}return false});$(document).on("mousedown","select.disabled-select",function(d){d.preventDefault();this.blur();window.focus();return false});$(document).on("focus","select.disabled-select",function(d){d.preventDefault();this.blur();window.focus();return false});if(false&&typeof processUserTimeoutLeft==="function"){userTimeoutIntervalTimer=setInterval(function(){if(!$("body").hasClass("waiting-for-ajax")){$("body").addClass("no-waiting-for-ajax");$.ajax({url:"/index.php?ajax=true&url_action=get_user_timeout_seconds",type:"GET",timeout:(empty(gDefaultAjaxTimeout)?30000:gDefaultAjaxTimeout),success:function(d){var e=processReturn(d);if(e===false){return}if("seconds_left" in e){processUserTimeoutLeft(e.seconds_left)}},error:function(d,f,e){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax")},dataType:"text"})}},60000)}$(document).on("keydown",".monthpicker",function(d){if(d.which==8||d.which==46){$(this).val("")}});$(document).on("tap click",".clickable",function(){const d=$(this).data("script_filename");if(empty(d)){return true}if(d.substring(0,4)=="http"){window.open(d)}else{document.location=d}});$(document).on("tap click",".page-help-button",function(){var d=$(this).data("file_id");if(d!=""&&d!=undefined){window.open("/download.php?id="+d);return}var e=$(this).data("remote_file_id");if(e!=""&&e!=undefined){window.open(remoteHelpDomain+"/download.php?id="+e);return}$("#_page_help").dialog({autoOpen:true,closeOnEscape:true,draggable:true,resizable:true,modal:true,position:{my:"center top",at:"center top+100px",of:window,collision:"none"},minWidth:400,width:800,minHeight:200,height:500,title:"Page Help",buttons:{Close:function(f){$("#_page_help").dialog("close")}}});return false});$(document).on("click","table.header-sortable th",function(){var k=$(this).closest("table.header-sortable").data("before_sort");if(typeof window[k]==="function"){window[k]()}var g=$(this).parent().children().index($(this));var l=1;if($(this).hasClass("header-sorted-up")){l=-1}var f=new Array();var e=0;$(this).closest("table").find("tr").each(function(){if($(this).is(".header-row")||$(this).is(".footer-row")){return true}e++;var m=$(this).attr("id");if(m==""||m==undefined){m=makeId()+"_"+e;$(this).attr("id",m)}var n=$(this).find("td:eq("+g+")");if(n.attr("data-sort_value")){var o=n.data("sort_value")}else{var o=n.text().replace(/,/g,"").toLowerCase()}f.push({data_value:o,row_id:m})});var d=0;for(var h in f){d++}if(d>0){f.sort(function(n,m){if(n.data_value==m.data_value){return 0}else{if($.isNumeric(n.data_value.replace("$",""))&&$.isNumeric(m.data_value.replace("$",""))){return(parseFloat(n.data_value.replace("$",""))<parseFloat(m.data_value.replace("$",""))?-1:1)*l}else{if(isDate(n.data_value)&&isDate(m.data_value)){var p=$.formatDate(new Date(Date.parse(n.data_value)),(n.data_value.length>10?"yyyy/MM/dd HH:mm:ss":"yyyy/MM/dd"));var o=$.formatDate(new Date(Date.parse(m.data_value)),(m.data_value.length>10?"yyyy/MM/dd HH:mm:ss":"yyyy/MM/dd"));return(p<o?-1:1)*l}else{return(n.data_value<m.data_value?-1:1)*l}}}});for(var h in f){if($(this).closest("table.header-sortable").find("tr.footer-row").length>0){$(this).closest("table").find("#"+f[h].row_id).insertBefore($(this).closest("table.header-sortable").find(".footer-row").eq(0))}else{$(this).closest("table").find("#"+f[h].row_id).appendTo($(this).closest("table.header-sortable"))}}}$(this).closest("table.header-sortable").find("tr.header-row").find("span.fa-sort-alpha-down-alt,span.fa-sort-alpha-down").remove();$(this).closest("table.header-sortable").find("th.header-sorted-column").removeClass("header-sorted-column");$(this).closest("table.header-sortable").find("th.header-sorted-up").removeClass("header-sorted-up");$(this).closest("table.header-sortable").find("th.header-sorted-down").removeClass("header-sorted-down");$(this).append("<span class='fad fa-sort-alpha-down"+(l==1?"":"-alt")+"'></span>").addClass("header-sorted-column").addClass((l==1?"header-sorted-up":"header-sorted-down"));var j=$(this).closest("table.header-sortable").data("after_sort");if(typeof window[j]==="function"){window[j]()}});$(".password-strength").keyup(function(){if(empty($(this).val())){$("#"+$(this).attr("id")+"_strength_bar_div").addClass("hidden")}else{checkPasswordStrength($(this).attr("id"))}});$(".password-strength").change(function(){if(empty($(this).val())){$("#"+$(this).attr("id")+"_strength_bar_div").addClass("hidden")}else{if(checkPasswordStrength($(this).attr("id"))<minimumPasswordStrength){$("#"+$(this).attr("id")+"_strength_bar_div").removeClass("hidden");$("#"+$(this).attr("id")+"_strength_bar").css("background-color","FF0000");$("#"+$(this).attr("id")+"_strength_bar_label").html("Password is too weak");$(this).val("").focus()}}});if($().imageSlider){$(".image-slider").imageSlider()}$("a").on("click tap",function(h){if(typeof ga!=="function"){return}var g=$(this);var d=true;var e=(typeof(g.attr("href"))!="undefined")?g.attr("href"):"";if(e==""){return}var f=e.match(document.domain.split(".").reverse()[1]+"."+document.domain.split(".").reverse()[0]);var k=[];k.value=0,k.non_i=false;if(e.indexOf("download.php")>-1){k.category="download";k.action="download-file";var j=g.data("description");if(j==""||j==undefined){k.label=e.replace(/ /g,"-")}else{k.label=j}k.loc=e}else{d=false}if(d){ga("send","event",k.category,k.action,k.label,{page:k.loc});if(g.attr("target")==undefined||g.attr("target").toLowerCase()!="_blank"){setTimeout(function(){location.href=k.loc},400);return false}}});$("table").attr("cellspacing","0px").attr("cellpadding","0px");$(document).on("keypress","input,select",function(d){return d.keyCode!=13});var c=location.host;var b=location.host.split(".");if(b.length>1){c=b[b.length-2]+"."+b[b.length-1]}$("a[href^='http']").add("area[href^='http']").add("a[href^='//']").add("area[href^='http']").add("a[href*='download.php']").add("a.download-file-link").not("a[rel^='prettyPhoto']").not("a[href*='"+c+"']").not(".same-page").attr("target","_blank");if($().prettyPhoto){$("a[rel^='prettyPhoto'],a.pretty-photo").prettyPhoto({social_tools:false,default_height:480,default_width:854,deeplinking:false})}$(document).on("focus","input,select,textarea",function(){lastFocusFieldId=$(this).attr("id")});if($().minicolors){$(".minicolors").minicolors({letterCase:"uppercase",control:"wheel"})}$(document).on("keypress","input[type=text][class*='custom[date]']:not(readonly):not(.monthpicker)",function(d){switch(d.which){case 46:$(this).val($.formatDate(new Date(),"MM/dd/yyyy"));return false;case 45:$(this).val(addDays($(this).val(),-1));return false;case 61:case 43:$(this).val(addDays($(this).val(),1));return false;default:return true}});$(document).on("keypress","input[type=text][class*='custom[time]']:not(readonly)",function(d){switch(d.which){case 46:$(this).val($.formatDate(new Date(),"h:mm a"));return false;default:return true}});$(document).ajaxStart(function(){if(!$("body").hasClass("no-waiting-for-ajax")){$("body").addClass("waiting-for-ajax")}}).ajaxStop(function(){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax")});if($().timepicker){$(".timepicker").timepicker({showPeriod:true,showLeadingZero:false})}installDatePicker();$(".required-label").append("<span class='required-tag fa fa-asterisk'></span>");$(document).on("tap click",".menu-item",function(f){var e=$(this).data("script_filename");if(empty(e)){e=$(this).find("a").attr("href")}if("gUserUid" in window&&"gUserKey" in window){e=e.replace("%userUid%",gUserUid).replace("%userKey%",gUserKey)}else{e=e.replace("%userUid%","").replace("%userKey%","")}if(e!=""&&e!=undefined){f.stopPropagation();if(e.substring(0,1)=="#"){var d=0;if($(this.hash).offset().top>$(document).height()-$(window).height()){d=$(document).height()-$(window).height()}else{d=$(this.hash).offset().top}$("html,body").animate({scrollTop:d},1000,"swing");return false}else{setTimeout(function(){return goToLink($(this),e,$(this).data("separate_window")=="YES"||f.altKey||f.metaKey||f.ctrlKey)},100)}}return false});$(document).on("tap click",".menu-item a",function(f){var e=$(this).closest(".menu-item").data("script_filename");if(empty(e)){e=$(this).attr("href")}if("gUserUid" in window&&"gUserKey" in window){e=e.replace("%userUid%",gUserUid).replace("%userKey%",gUserKey)}else{e=e.replace("%userUid%","").replace("%userKey%","")}if(e!=""&&e!=undefined){f.stopPropagation();if(e.substring(0,1)=="#"){var d=0;if($(this.hash).offset().top>$(document).height()-$(window).height()){d=$(document).height()-$(window).height()}else{d=$(this.hash).offset().top}$("html,body").animate({scrollTop:d},1000,"swing");return false}else{setTimeout(function(){return goToLink($(this).closest(".menu-item"),e,$(this).closest(".menu-item").data("separate_window")=="YES"||f.metaKey||f.ctrlKey)},100)}}return false});$("div[src]").each(function(){var d=$(this);$.ajax({url:d.attr("src"),type:"GET",timeout:(empty(gDefaultAjaxTimeout)?30000:gDefaultAjaxTimeout),success:function(e){d.html(e);$("table").attr("cellspacing","0px").attr("cellpadding","0px");$("a[href^='http']").add("area[href^='http']").add("a[href*='download.php']").add("a.download-file-link").not("a[rel^='prettyPhoto']").attr("target","_blank");$("a[rel^='prettyPhoto'],a.pretty-photo").prettyPhoto({social_tools:false,default_height:480,default_width:854,deeplinking:false})},dataType:"text"})});$(document).on("tap click",".photo-gallery-album",function(){var f=$(this).data("album_id");var e=$(this).closest(".photo-gallery").data("top_album_id");var d=$(this).closest(".photo-gallery").data("download_link");$.ajax({url:"photoalbum.php?ajax=true&url_action=get_gallery&album_id="+f+"&download_link="+d+(e!=f?"&parent=true":""),type:"GET",timeout:(empty(gDefaultAjaxTimeout)?30000:gDefaultAjaxTimeout),success:function(g){var h=processReturn(g);if(h===false){return}if("gallery_content" in h){$("#_gallery_"+e).data("album_id",f).html(h.gallery_content)}if($().prettyPhoto){$("a[rel^='prettyPhoto'],a.pretty-photo").prettyPhoto({social_tools:false,default_height:480,default_width:854,deeplinking:false})}},error:function(g,j,h){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax");displayErrorMessage("The server is not responding. Try again in a few minutes. #856")},dataType:"text"});return false});if($("form").length>0&&$().validationEngine){$("form").validationEngine()}if($(".tabbed-form").length>0&&$().tabs){var a=($("#_active_tab").length>0?$("#_active_tab").val()-0:0);$(".tabbed-form").tabs({active:a,beforeActivate:function(d,e){$("#_edit_form").validationEngine("hideAll")},activate:function(d,e){if("scriptFilename" in window){$("body").addClass("no-waiting-for-ajax");$.ajax({url:scriptFilename+"?ajax=true&url_action=select_tab&tab_index="+$(this).tabs("option","active"),type:"GET",timeout:(empty(gDefaultAjaxTimeout)?30000:gDefaultAjaxTimeout),success:function(f){var g=processReturn(f);if(g===false){return}},error:function(f,h,g){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax");displayErrorMessage("The server is not responding. Try again in a few minutes. #1883")},dataType:"text"})}},cookie:{expires:120}})}$(document).on("keydown",".autocomplete-field",function(e){if(e.which==33||e.which==34){return true}if($(this).prop("readonly")&&e.which!=9&&(e.which<16||e.which>18)&&e.which!=91){return false}if($("#autocomplete_options").length==0){$("body").append("<div id='autocomplete_options'><ul></ul></div>")}if($("#autocomplete_options").data("field_name")!=$(this).attr("id")){$(this).data("last_autocomplete_data","")}$("#autocomplete_options").data("field_name",$(this).attr("id"));if(e.which!=9&&(e.which<37||e.which>40)&&(e.which<16||e.which>18)){$("#"+$(this).attr("id").replace("_autocomplete_text","")).val("").trigger("change")}if(e.which==40){var d=$("#autocomplete_options ul li.selected").index();d++;if(d>=$("#autocomplete_options ul li").length){d=0}$("#autocomplete_options ul li.selected").removeClass("selected");$("#autocomplete_options ul li:eq("+d+")").addClass("selected");showAutocompleteSelection();return false}else{if(e.which==38){var d=$("#autocomplete_options ul li.selected").index();d--;if(d<0){d=$("#autocomplete_options ul li").length-1}$("#autocomplete_options ul li.selected").removeClass("selected");$("#autocomplete_options ul li:eq("+d+")").addClass("selected");showAutocompleteSelection();return false}else{if(e.which==13||e.which==3||e.which==9){if($("#autocomplete_options ul li.selected").length>0){var f=$("#autocomplete_options").data("field_name");$("#"+f).val($("#autocomplete_options ul li.selected").text());$("#"+f.replace("_autocomplete_text","")).val($("#autocomplete_options ul li.selected").data("id_value")).trigger("change");$("#"+f).data("last_autocomplete_data",$("#"+f).val());$("#autocomplete_options").hide()}if(e.which==9){return true}else{return false}}}}return true}).on("blur",".autocomplete-field",function(){if($(this).prop("readonly")){return false}var d=$(this).attr("id");setTimeout(function(){$("#autocomplete_options").hide();if($("#"+d.replace("_autocomplete_text","")).val()==""){$("#"+d.replace("_autocomplete_text","")).val($("#autocomplete_options ul li").filter(function(){if($(this).text().toLowerCase()==$("#"+d).val().toLowerCase()){$("#"+d).val($(this).text());return true}else{return false}}).data("id_value")).trigger("change")}if($("#"+d.replace("_autocomplete_text","")).val()==""){$("#"+d).data("last_autocomplete_data","");$("#"+d).val("")}},200)}).on("focus",".autocomplete-field",function(){if($("#autocomplete_options").length==0){$("body").append("<div id='autocomplete_options'><ul></ul></div>")}if($(this).prop("readonly")){return false}if($("#autocomplete_options").data("field_name")!=$(this).attr("id")){$(this).data("last_autocomplete_data","")}$("#autocomplete_options").data("field_name",$(this).attr("id"))}).on("keyup",".autocomplete-field",function(f){if(f.which==33||f.which==34){return true}if($(this).prop("readonly")&&f.which!=9&&(f.which<16||f.which>18)&&f.which!=91){return false}if(f.which!=9&&(f.which<37||f.which>40)&&(f.which<16||f.which>18)&&f.which!=13&&f.which!=3){var e=$(this).val();if(getAutocompleteTimer!=null){clearTimeout(getAutocompleteTimer)}var d=$(this).attr("id");if(e.length>=2){getAutocompleteTimer=setTimeout(function(){getAutocompleteData(d)},400)}else{$("#autocomplete_options ul li.selected").removeClass("selected");$("#autocomplete_options").hide()}}}).on("get_autocomplete_text",".autocomplete-field",function(){var d=$(this).attr("id");var e=$("#"+d.replace("_autocomplete_text","")).val();var f=$("#"+d).data("additional_filter");var g=$("#"+d).data("additional_filter_function");if(g!=undefined&&typeof window[g]=="function"){f=window[g](d.replace("_autocomplete_text",""))}if(f==undefined){f=""}if($("#autocomplete_options").length==0){$("body").append("<div id='autocomplete_options'><ul></ul></div>")}if(e==""){$("#"+d).val("")}else{$("body").addClass("no-waiting-for-ajax");$.ajax({url:"getautocompletedata.php?ajax=true&tag="+$("#"+d).data("autocomplete_tag")+"&value_id="+encodeURIComponent(e)+"&get_value=true&additional_filter="+encodeURIComponent(f),type:"GET",timeout:(empty(gDefaultAjaxTimeout)?30000:gDefaultAjaxTimeout),success:function(h){var j=processReturn(h);if(j===false){return}if("autocomplete_text" in j){$("#"+d).val(j.autocomplete_text);$("#"+d).data("last_autocomplete_data",$("#"+d).val())}},error:function(h,k,j){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax")},dataType:"text"})}});$(document).on("click","#autocomplete_options ul li",function(){var d=$("#autocomplete_options").data("field_name");$("#"+d).val($(this).text());$("#"+d).data("last_autocomplete_data",$("#"+d).val());$("#"+d.replace("_autocomplete_text","")).val($(this).data("id_value")).trigger("change");$("#autocomplete_options ul li.selected").removeClass("selected");$("#"+d).focus()});$("#_subscribe_form_button").click(function(f){f.preventDefault();if($("#_subscribe_form").length===0||$("#signup_email_address").length===0){return}const d="/"+scriptFilename+"?ajax=true&url_action=newsletter_signup";if($("#_subscribe_form").validationEngine("validate")){$.ajax({url:d,type:"POST",data:$("#_subscribe_form").serialize(),timeout:30000,success:function(e){var g=processReturn(e);if(g===false){return}if(!("error_message" in g)){$("#_subscribe_form_wrapper").html("<p id='_subscribe_response'>You're signed up</p>")}},error:function(e,h,g){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax");displayErrorMessage("Server not responding... please try again")}})}})});$(window).on("load",function(){if($(".equal-height-blocks").length>0){setTimeout(function(){equalizeBlockHeights()},1000);$(window).on("resize",function(){clearTimeout(equalizerTimer);equalizerTimer=setTimeout(function(){equalizeBlockHeights()},500)})}});$(window).on("load",function(){if($(".equal-width-blocks").length>0){setTimeout(function(){equalizeBlockWidths()},1000);$(window).on("resize",function(){clearTimeout(equalizerTimer);equalizerTimer=setTimeout(function(){equalizeBlockWidths()},500)})}});$(window).on("load",function(){setTimeout(function(){$(".defer-load").each(function(){const b=$(this).data("image_source");if(!empty(b)){$(this).attr("src",b)}const a=$(this).data("background_image");if(!empty(a)){$(this).css("background-image","url('"+a+"')")}})},100)});$.fn.redraw=function(){$(this).each(function(){var a=this.offsetHeight})};$.fn.clearForm=function(){return this.each(function(){if($(this).hasClass("no-clear")){return true}var b=this.type,a=this.tagName.toLowerCase();if(a=="form"){return $(":input",this).clearForm()}if(b=="file"||b=="text"||b=="password"||a=="textarea"||b=="hidden"){$(this).val("")}else{if(b=="checkbox"||b=="radio"){this.checked=false}else{if(a=="select"){if($(this).find("option[value='']").length>0){this.value=""}else{this.selectedIndex=-1}}}}})};$.fn.swapWith=function(a){return this.each(function(){var b=$(a).clone(true);$(a).replaceWith(this);$(this).replaceWith(b)})};(function(a){a.formatDate=function(e,h){if(typeof(e)=="string"){var g=e.split("/");if(g.length==3){var j=g[0];var d=g[1];var f=g[2]}else{var g=e.split("-");if(g.length==3){var f=g[0];var j=g[1];var d=g[2]}}if(f<100){f+=2000}e=new Date(f,j-1,d)}var c=[];while(h.length>0){a.formatDate.patternParts.lastIndex=0;var b=a.formatDate.patternParts.exec(h);if(b){c.push(a.formatDate.patternValue[b[0]].call(this,e));h=h.slice(b[0].length)}else{c.push(h.charAt(0));h=h.slice(1)}}return c.join("")};a.formatDate.patternParts=/^(yy(yy)?|M(M(M(M)?)?)?|d(d)?|EEE(E)?|a|H(H)?|h(h)?|m(m)?|s(s)?|S)/;a.formatDate.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];a.formatDate.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];a.formatDate.patternValue={yy:function(b){return a.toFixedWidth(b.getFullYear(),2)},yyyy:function(b){return b.getFullYear().toString()},MMMM:function(b){return a.formatDate.monthNames[b.getMonth()]},MMM:function(b){return a.formatDate.monthNames[b.getMonth()].substr(0,3)},MM:function(b){return a.toFixedWidth(b.getMonth()+1,2)},M:function(b){return b.getMonth()+1},dd:function(b){return a.toFixedWidth(b.getDate(),2)},d:function(b){return b.getDate()},EEEE:function(b){return a.formatDate.dayNames[b.getDay()]},EEE:function(b){return a.formatDate.dayNames[b.getDay()].substr(0,3)},HH:function(b){return a.toFixedWidth(b.getHours(),2)},H:function(b){return b.getHours()},hh:function(c){var b=c.getHours();return a.toFixedWidth(b>12?b-12:b,2)},h:function(c){var b=c.getHours();return(b==0?12:(b>12?b-12:b))},mm:function(b){return a.toFixedWidth(b.getMinutes(),2)},m:function(b){return b.getMinutes()},ss:function(b){return a.toFixedWidth(b.getSeconds(),2)},s:function(b){return b.getSeconds()},S:function(b){return a.toFixedWidth(b.getMilliseconds(),3)},a:function(c){var b=c.getHours();var d=c.getMinutes();return(b==0&&d==0?"midnight":(b==12&&d==0?"noon":b<12?"am":"pm"))}}})(jQuery);function goToLink(b,a,d){if(a==undefined&&d==undefined){a=b;b=null}if(d==null||d==undefined){d=false}if(a==""){return false}try{if(d){window.open(a)}else{if("changesMade" in window&&changesMade()){askAboutChanges(function(){$("#_edit_form").clearForm();$("body").data("just_saved","true");document.location=a})}else{document.location=a}}}catch(c){document.location=a}return false}function addCSSRule(b,a,c){for(var f=0;f<document.styleSheets.length;f++){var j=document.styleSheets[f];var h=(j.cssRules||j.rules);var k=b.toLowerCase();for(var e=0,g=h.length;e<g;e++){if(h[e].selectorText&&(h[e].selectorText.toLowerCase()==k)){if(c!=null){var d=a;if(d in h[e].style){h[e].style[d]=c}else{d=a.replace(/(-.)/g,function(l){return l[1].toUpperCase()});if(d in h[e].style){h[e].style[d]=c}}return}else{if(j.deleteRule){j.deleteRule(e)}else{if(j.removeRule){j.removeRule(e)}else{h[e].style.cssText=""}}}}}}var j=document.styleSheets[0]||{};if(j.insertRule){var h=(j.cssRules||j.rules);j.insertRule(b+"{ "+a+":"+c+"; }",h.length)}else{if(j.addRule){j.addRule(b,a+":"+c+";",0)}}}var clearMessageTimer=null;function displayErrorMessage(b,a){if("thisIsAPublicWebsite" in window&&thisIsAPublicWebsite){if(b.toLowerCase().indexOf("not respond")>0){b="";return}}if(a==null){a=true}if(empty(b)){clearMessage()}if($("#_error_message").add(".error-message").length>0){$("#_error_message").add(".error-message").removeClass("info-message").html(b).addClass("error-visible").show()}console.log(b);if(clearMessageTimer!=null){clearTimeout(clearMessageTimer)}clearMessageTimer=null;if(a){clearMessageTimer=setTimeout("clearMessage()",5000)}else{if(clearMessageTimer!=null){clearTimeout(clearMessageTimer);clearMessageTimer=null}}}function displayInfoMessage(b,a){if(a==null){a=true}if(empty(b)){clearMessage()}$("#_error_message").add(".error-message").addClass("info-message").html(b).addClass("error-visible").show();if(a){clearMessageTimer=setTimeout("clearMessage()",10000)}else{if(clearMessageTimer!=null){clearTimeout(clearMessageTimer);clearMessageTimer=null}}}function clearMessage(){if(clearMessageTimer!=null){clearTimeout(clearMessageTimer)}clearMessageTimer=null;$("#_error_message").add(".error-message").removeClass("error-visible").html("")}var Crc32Tab=new Array(0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918000,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117);function Crc32Add(a,b){return Crc32Tab[(a^b)&255]^((a>>8)&16777215)}function Crc32Str(d){if(d==undefined){d=""}if(typeof(d)=="array"||typeof(d)=="object"){d=d.join(",")}var e;var a=d.length;var c;c=4294967295;for(e=0;e<a;e++){var b=d.charCodeAt(e);if(b==13&&e<(a-1)&&d.charCodeAt(e+1)==10){continue}if(b>122){continue}if(b<32){b=32}c=Crc32Add(c,b)}return c^4294967295}function Hex32(c){var d;var b;var a;d=c&65535;b=d.toString(16).toUpperCase();while(b.length<4){b="0"+b}d=(c>>>16)&65535;a=d.toString(16).toUpperCase();while(a.length<4){a="0"+a}return a+b}function getCrcValue(b,a){if(a==null||a==undefined){a=false}return(a?"":"#")+Hex32(Crc32Str(b+""))}$.toFixedWidth=function(c,b,e){var a=(c||"").toString();e=e||"0";var d=b-a.length;if(d<0){a=a.substr(-d)}else{for(var f=0;f<d;f++){a=e+a}}return a};function addDays(d,b){var c=3600*1000*24;if(d.length==0){return $.formatDate(new Date(),"MM/dd/yyyy")}try{var a=Date.parse(d)}catch(f){return""}var e=a+(c*b)+3600001;if(isNaN(e)){return""}return $.formatDate(new Date(e),"MM/dd/yyyy")}function Round(b,a){return Math.round(parseFloat((b+"").replace(/,/g,""))*Math.pow(10,a))/Math.pow(10,a)}function RoundFixed(c,a,b){if(empty(b)){b=false}if(b){return Round(c,a).toFixed(a)}else{return addCommas(Round(c,a).toFixed(a))}}function addCommas(b){var a=b.toString().split(".");a[0]=a[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return a.join(".")}function processReturn(a){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax");var c=new Object();try{c=JSON.parse(a)}catch(b){if("displayErrors" in window&&"showError" in window&&displayErrors){showError(a);return false}}if(!(c instanceof Array)&&!(c instanceof Object)){if("displayErrors" in window&&"showError" in window&&displayErrors){showError(a);return false}c=new Object()}if("debug" in c){console.log(a)}if("console" in c){console.log(c.console)}if("error_message" in c){displayErrorMessage(c.error_message)}if("info_message" in c){displayInfoMessage(c.info_message)}return c}function getURLParameter(a){return decodeURIComponent((new RegExp("[?|&]"+a+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function getURLParameters(a){var c={};var d=a.substring(a.indexOf("?")+1).split("&");for(var b=0;b<d.length;b++){if(!d[b]){continue}var e=d[b].split("=");c[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return c}function validatePostalCode(f){if(f==null||f==undefined){f="postal_code"}var a=$("#"+f).data("state_field");if(empty(a)){a="state"}var d=$("#"+f).data("city_field");if(empty(d)){d="city"}var b=$("#"+f).data("city_select_field");if(empty(b)){b=d+"_select"}var c=$("#"+f).data("city_hide");if(empty(c)){c="_"+d+"_row"}var e=$("#"+f).data("city_select_hide");if(empty(e)){e="_"+d+"_select_row"}if($("#"+f).val()==""){return}$.ajax({url:"validatepostalcode.php?ajax=true&postal_code="+$("#"+f).val(),type:"GET",timeout:(empty(gDefaultAjaxTimeout)?30000:gDefaultAjaxTimeout),success:function(k){var l=processReturn(k);if(l===false){return}var h=0;var j=$("#"+d).val();$("#"+b+" option").remove();for(var g in l.cities){h++;$("#"+b).append($("<option></option>",{value:l.cities[g]["city"],text:l.cities[g]["city"]}).data("state",l.cities[g]["state"]))}$("#"+e).hide();$("#"+c).show();if(h==0){$("#"+d).val("");$("#"+a).val("");$("#"+f).val("").focus()}else{if(h==1){$("#"+d).val($("#"+b).val());$("#"+a).val($("#"+b+" option:selected").data("state"))}else{$("#"+e).show();$("#"+c).hide();$("#"+b).val(j);if($("#"+b).val()!=j||$("#"+b).val()==null){$("#"+b).val($("#"+b+" option:first").val());$("#"+d).val($("#"+b).val());$("#"+b).focus()}$("#"+a).val($("#"+b+" option:selected").data("state"))}}},error:function(g,j,h){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax");displayErrorMessage("The server is not responding. Try again in a few minutes. #197")},dataType:"text"})}var commonPasswords=new Array("password","pass","1234","1246","asdf","qwerty","123456","12345678","12345","dragon","pussy","baseball","football","letmein","monkey","696969","abc123","mustang","michael","shadow","master","jennifer","111111");var minimumLength=6;var recommendedLength=8;var numbers="0123456789";var lowercase="abcdefghijklmnopqrstuvwxyz";var uppercase="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var punctuation="!@#$%^&*()_+=-{}[]|:';,./?><`~";var strength_label=Array("Too common or repetitive","Weak","Fair","Medium","Strong","Very Strong");var strength_color=Array("FF0000","FF9900","FFCC33","99CC99","ffd801","3bce08");function checkPasswordStrength(g){var d=$("#"+g).val();var b=0;var f=0;if(d.length==0){return f}var h="";if($("#user_name").length>0){h=$("#user_name").val()}if(d.length>=h.length&&d.indexOf(h)==0){d=d.substring(h.length)}for(var e=0;e<commonPasswords.length;e++){if(d.length>=commonPasswords[e].length&&d.indexOf(commonPasswords[e])==0){d=d.substring(commonPasswords[e].length)}}b+=d.length;b+=(contains(d,numbers)>0?30:0);b+=(contains(d,lowercase)>0?10:0);b+=(contains(d,uppercase)>0?20:0);b+=(contains(d,punctuation)>0?40:0);if(d.length>2){b+=(contains(d.substring(1,d.length-1),punctuation)>0?20:0)}if(d.length>2){b+=(contains(d.substring(1,d.length-1),numbers)>0?20:0)}if(d.length>=recommendedLength){b+=10}else{if(d.length>=minimumLength){b+=5}else{b=0}}if(isCommonPassword(d)){b=0}if(contains(d,numbers+lowercase+uppercase+punctuation)<3){b=0}var c=b/100;var a=Math.max(1,Math.min(Math.round(c*100),100));$("#"+g+"_strength_bar_div").removeClass("hidden");$("#"+g+"_strength_bar").css("width",a+"%");if(c>0.85){f=5}else{if(c>0.7){f=4}else{if(c>0.55){f=3}else{if(c>0.4){f=2}else{if(c>0.25){f=1}else{f=0}}}}}$("#"+g+"_strength_bar").css("background-color","#"+strength_color[f]);$("#"+g+"_strength_bar_label").html(strength_label[f]);return f}function isCommonPassword(b){for(i=0;i<commonPasswords.length;i++){var a=commonPasswords[i];if(b==a){return true}}return false}function contains(c,a){count=0;var d="";for(i=0;i<c.length;i++){var b=c.charAt(i);if(a.indexOf(b)>-1&&d.indexOf(b)==-1){count++;d+=b}}return count}function scrollInView(b,a){if(a==null||a==undefined){a=0}var c=b.offset().top-$(window).scrollTop();$("html,body").animate({scrollTop:(c+a)},1000);return false}function isScrolledIntoView(d){var b=d.offset().top;var e=b+d.outerHeight();var a=$(window).scrollTop();var c=a+$(window).height();return e>a&&b<c}function isInsideViewPort(d){var b=d.offset().top;var e=b+d.outerHeight();var a=$(window).scrollTop();var c=a+$(window).height();return e<c&&b>a}function isOutsideViewPort(d){var b=d.offset().top;var e=b+d.outerHeight();var a=$(window).scrollTop();var c=a+$(window).height();return e<a||b>c}function isValidEmailAddress(b){var a=new RegExp(/^(("[\w-+\s]+")|([\w-+]+(?:\.[\w-+]+)*)|("[\w-+\s]+")([\w-+]+(?:\.[\w-+]+)*))(@((?:[\w-+]+\.)*\w[\w-+]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);return a.test(b)}function makeId(){var c="";var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var b=0;b<6;b++){c+=a.charAt(Math.floor(Math.random()*a.length))}return c}function isInArray(d,c,a){if(empty(d)){return false}if(typeof c==="string"){c=c.split(",")}if(empty(a)){a=false}for(var b=0;b<c.length;b++){if(a){if(c[b]==d){return true}}else{if(String(c[b]).toLowerCase()==String(d).toLowerCase()){return true}}}return false}function createCookie(c,d,e){var a="";if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));a="; expires="+b.toUTCString()}document.cookie=c+"="+d+a+"; path=/"}function readCookie(b){var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return f.substring(e.length,f.length)}}return null}function eraseCookie(a){createCookie(a,"",-1)}function disableButtons(a){if(a==undefined){$(".page-button").addClass("disabled-button").prop("disabled",true)}else{$(a).addClass("disabled-button").prop("disabled",true)}}function enableButtons(a){if(a==undefined){$(".page-button.enabled-button").removeClass("disabled-button").prop("disabled",false)}else{$(a).removeClass("disabled-button").prop("disabled",false)}}function isDate(b){if(b.charAt(2)!="/"||b.charAt(5)!="/"){return false}var a=new Date(b);return !isNaN(a.valueOf())}function isTouchDevice(){return"ontouchstart" in window||navigator.maxTouchPoints}var lastMilliseconds=0;function getElapsedTime(d){var c=new Date();var b=c.getTime();if(lastMilliseconds>0){var a=RoundFixed(((b-lastMilliseconds)/1000),2);console.log(d+": "+a)}lastMilliseconds=b}function empty(b){var e,d,c,a;var f=[e,null,false,0,"","0","0.0","0.00","0.000","0.0000"];if(typeof b==="string"){b=b.trim()}for(c=0,a=f.length;c<a;c++){if(b===f[c]){return true}}if(typeof b==="object"){for(d in b){if(b.hasOwnProperty(d)){return false}}return true}return false}function loadAdminMenu(c,a,b){if("scriptFilename" in window){$.ajax({url:scriptFilename+"?ajax=true&url_action=get_admin_menu&menu_code="+c,type:"POST",data:b,timeout:(empty(gDefaultAjaxTimeout)?30000:gDefaultAjaxTimeout),success:function(d){var e=processReturn(d);if(e===false){return}if("menu" in e){$("#"+a).html(e.menu)}if(typeof afterLoadAdminMenu==="function"){afterLoadAdminMenu(c,a)}},error:function(d,f,e){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax");setTimeout(function(){loadAdminMenu(c,a,b)},200)},dataType:"text"})}}var equalizerTimer;function equalizeBlockHeights(){$(".blocks-being-equalized").removeClass("blocks-being-equalized");$(".equal-height-blocks").parent().closest("div").addClass("blocks-being-equalized");$(".blocks-being-equalized").each(function(){var b=0;$(this).find(".equal-height-blocks").css("height","auto");var a=$(this).find(".equal-height-blocks").data("minimum_width");if(a==undefined||a==null){a=550}if($(window).width()>a){$(this).find(".equal-height-blocks").each(function(){if($(this).outerHeight()>b){b=$(this).outerHeight()}});$(this).find(".equal-height-blocks").css("height",b+"px")}$(this).removeClass("blocks-being-equalized")})}function equalizeBlockWidths(){$(".blocks-being-equalized").removeClass("blocks-being-equalized");$(".equal-width-blocks").parent().closest("div").addClass("blocks-being-equalized");$(".blocks-being-equalized").each(function(){var b=0;$(this).find(".equal-width-blocks").css("width","auto");var a=$(this).find(".equal-width-blocks").data("minimum_width");if(a==undefined||a==null){a=550}if($(window).width()>a){$(this).find(".equal-width-blocks").each(function(){if($(this).outerWidth()>b){b=$(this).outerWidth()}});$(this).find(".equal-width-blocks").css("width",b+"px")}$(this).removeClass("blocks-being-equalized")})}var moveableBackgroundFollowX=0,moveableBackgroundFollowY=0,moveableBackgroundX=0,moveableBackgroundY=0,moveableBackgroundFriction=1/30;function moveBackground(){moveableBackgroundX+=(moveableBackgroundFollowX-moveableBackgroundX)*moveableBackgroundFriction;moveableBackgroundY+=(moveableBackgroundFollowY-moveableBackgroundY)*moveableBackgroundFriction;translate="translate("+moveableBackgroundX+"px, "+moveableBackgroundY+"px) scale(1.1)";$(".moveable-background").css({"-webit-transform":translate,"-moz-transform":translate,transform:translate});window.requestAnimationFrame(moveBackground)}$(function(){if($(".moveable-background").length>0){$(window).on("mousemove click",function(a){var c=Math.max(-100,Math.min(100,$(window).width()/2-a.clientX));var b=Math.max(-100,Math.min(100,$(window).height()/2-a.clientY));moveableBackgroundFollowX=(20*c)/100;moveableBackgroundFollowY=(10*b)/100});moveBackground()}});function logBannerImpression(a){var c=$(a).data("banner_id");var b=$(a).data("banner_impression_log_id");if(!empty(b)){return}$("body").addClass("no-waiting-for-ajax");$.ajax({url:"/index.php?ajax=true&url_action=log_banner_impression&banner_id="+c,type:"GET",timeout:(empty(gDefaultAjaxTimeout)?30000:gDefaultAjaxTimeout),success:function(d){var e=processReturn(d);if(e===false){return}if(!empty(a)){$(a).data("banner_impression_log_id",e.banner_impression_log_id)}},error:function(d,f,e){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax")},dataType:"text"})}function logBannerClick(b,a){var d=$(b).data("banner_id");var c=$(b).data("banner_impression_log_id");if(empty(d)){if(typeof a=="function"){a()}return false}if(empty(c)){c=""}$("body").addClass("no-waiting-for-ajax");$.ajax({url:"/index.php?ajax=true&url_action=log_banner_click&banner_id="+d+"&banner_impression_log_id="+c,type:"GET",timeout:(empty(gDefaultAjaxTimeout)?30000:gDefaultAjaxTimeout),success:function(e){var f=processReturn(e);if(f===false){return}if(typeof a=="function"){a()}},error:function(e,g,f){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax")},dataType:"text"});return false}function processMagneticData(a,f){if(empty(f)){f=false}$("#payment_method_id").data("swipe_string","");$("#account_id").data("swipe_string","");if(a.substring(0,2)!="%B"){return}a=a.substring(2);stringParts=a.split("^");if(stringParts.length<3){return}var k=$.trim(stringParts[0].replace(/\s/g,""));var l=$.trim(stringParts[1]).split("/");var g="";var h="";var j="";var d="";if(l.length!=2){d=l.join(" ")}else{var h=l[1];if(h.substring(h.length-3)==" MR"){h=h.substring(0,h.length-3)}if(h.substring(h.length-4)==" MRS"){h=h.substring(0,h.length-4)}var j=$.trim(l[0])}var e=parseInt(stringParts[2].substring(2,4));var c=parseInt(stringParts[2].substring(0,2))+2000;if(isNaN(c)||isNaN(e)||e<1||e>12){return}g=g.toLowerCase().replace(/(^|\s)([a-z])/g,function(n,p,o){return p+o.toUpperCase()});var b="";if(k.substring(0,1)=="4"){b="Visa"}else{if(k.substring(0,1)=="5"){b="MasterCard"}else{if(k.substring(0,4)=="6011"){b="Discover"}else{if((k.substring(0,2)=="34"||k.substring(0,2)=="37")&&k.length==15){b="American Express"}else{return}}}}$("#account_id").val("");$("#payment_method_id").find("option:contains('"+b+"')").prop("selected",true).trigger("change");$("#account_number").val(k);$("#expiration_month").val(e);$("#expiration_year").val(c);$("#billing_business_name").val(d);$("#billing_first_name").val(h);$("#billing_last_name").val(j);if(f){$("#first_name").val(h);$("#last_name").val(j)}}function createGoogleEvent(a,c,b,d){ga("send","event",a,c,b,d)}function calculateDistance(d,c){const a=3958;const b=57.29578;return(a*Math.PI*Math.sqrt((d.latitude-c.latitude)*(d.latitude-c.latitude)+Math.cos(d.latitude/b)*Math.cos(c.latitude/b)*(d.longitude-c.longitude)*(d.longitude-c.longitude))/180)}var getAutocompleteTimer=null;function getAutocompleteData(d){if($("#"+d).val()==$("#".fieldName).data("last_autocomplete_data")){$("#autocomplete_options").width($("#"+d).outerWidth()-2).css("left",$("#"+d).offset().left).css("top",$("#"+d).offset().top+$("#"+d).outerHeight()).show();return}$("#autocomplete_options ul li").remove();$("body").addClass("no-waiting-for-ajax");var b=$("#"+d).val();var a=$("#"+d).data("additional_filter");var c=$("#"+d).data("additional_filter_function");if(c!=undefined&&typeof window[c]=="function"){a=window[c](d.replace("_autocomplete_text",""))}if(a==undefined){a=""}if($("#autocomplete_options").length==0){$("body").append("<div id='autocomplete_options'><ul></ul></div>")}$.ajax({url:"getautocompletedata.php?ajax=true&tag="+$("#"+d).data("autocomplete_tag")+"&search_text="+encodeURIComponent(b.trim())+"&additional_filter="+encodeURIComponent(a),type:"GET",timeout:(empty(gDefaultAjaxTimeout)?30000:gDefaultAjaxTimeout),success:function(h){var k=processReturn(h);if(k===false){return}if("results" in k){var f=false;for(var e in k.results){if(k.results[e] instanceof Object){var j=k.results[e]["key_value"];var g=k.results[e]["description"]}else{var j=e;var g=k.results[e]}f=true;$("#autocomplete_options ul").append($("<li></li>").data("id_value",j).html(g.replace(new RegExp(b,"ig"),"<b>$&</b>")))}$("#autocomplete_options p").remove();if(!f){$("#autocomplete_options").prepend("<p>No matching results</p>")}$("#autocomplete_options").width($("#"+d).outerWidth()-2).css("left",$("#"+d).offset().left).css("top",$("#"+d).offset().top+$("#"+d).outerHeight()).show();$("#"+d).data("last_autocomplete_data",$("#"+d).val());$("#autocomplete_options ul li:eq(0)").addClass("selected");showAutocompleteSelection()}},error:function(e,g,f){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax")},dataType:"text"})}function showAutocompleteSelection(){if($("#autocomplete_options ul li.selected").length==0){return}var b=$("#autocomplete_options ul").position().top;var a=$("#autocomplete_options").height();var d=$("#autocomplete_options ul li.selected").position().top;var c=$("#autocomplete_options ul li").outerHeight();if((d+b)<0||d>(a-c-b)){var e=(d-(a/2)+(c/2));$("#autocomplete_options").animate({scrollTop:e},100)}}function installDatePicker(){if($().datepicker){if(empty($.datepicker._updateDatepicker_original)){$.datepicker._updateDatepicker_original=$.datepicker._updateDatepicker;$.datepicker._updateDatepicker=function(b){$.datepicker._updateDatepicker_original(b);var a=this._get(b,"afterShow");if(a){a.apply((b.input?b.input[0]:null))}}}$(".datepicker").not(".no-datepicker").datepicker({beforeShow:function(a,b){$(a).trigger("keydown")},onClose:function(b,a){$(this).trigger("keydown")},showOn:"button",buttonText:"<span class='far fa-calendar-alt'></span>",constrainInput:false,dateFormat:"mm/dd/yy",yearRange:"c-100:c+10"});$(".monthpicker").datepicker({showOn:"button",buttonText:"<span class='far fa-calendar-alt'></span>",constrainInput:true,changeMonth:true,changeYear:true,showButtonPanel:true,dateFormat:"MM yy",onClose:function(d,b){var c=$("#ui-datepicker-div .ui-datepicker-month :selected").val();var a=$("#ui-datepicker-div .ui-datepicker-year :selected").val();$(this).datepicker("setDate",new Date(a,c,1));$(".ui-datepicker-calendar").removeClass("monthpicker")},afterShow:function(a,b){$(".ui-datepicker-calendar").addClass("monthpicker")},yearRange:"c-100:c+10"}).prop("readonly",true)}$("#_templates").find(".hasDatepicker").removeClass("hasDatepicker");$("#_templates").find(".ui-datepicker-trigger").remove()}function addCKEditor(a){if(empty(a)){a="95%"}$(".ck-editor").each(function(){if(typeof CKEDITOR!=="undefined"){var b=$(this).data("id");if(empty(b)){b=$(this).attr("id");$(this).data("id",b)}if($(this).data("checked")=="true"){$(this).data("checked","false");$("#"+b).removeClass("wysiwyg");CKEDITOR.instances[b].destroy()}if($(this).data("checked")!="true"){$(this).data("checked","true");$("#"+b).addClass("wysiwyg");var c=$("#"+b).data("contents_css");var d=$("#"+b).data("styles_set");if(empty(d)){d=new Array()}if(typeof beforeCKEditorLoad==="function"){beforeCKEditorLoad()}CKEDITOR.replace(b,{resize_dir:"both",contentsCss:c,disableNativeSpellChecker:false,scayt_autoStartup:true,width:a,height:300,stylesSet:d,allowedContent:true,removePlugins:"flash,image",extraPlugins:"uploadimage",uploadUrl:"/ckeditorimageupload.php",removeButtons:"Select,HiddenField,ImageButton,Button,Textarea,TextField,Form,Radio,Checkbox,Iframe,PageBreak,InsertPre,Anchor,Language,BidiRtl,BidiLtr,ShowBlocks,Save,Print,Preview,NewPage,Templates",smiley_path:"/ckeditor/plugins/smiley/images/",coreStyles_bold:{element:"span",attributes:{"class":"highlighted-text"},styles:{"font-weight":"bold"}},coreStyles_italic:{element:"span",attributes:{"class":"italic"},styles:{"font-style":"bold"}}});if($("#"+b+"-ace_editor").length>0){$("#"+b+"-ace_editor").addClass("hidden")}}}})}function showOnloadWebsitePopup(){if(typeof beforeShowOnloadWebsitePopup=="function"){beforeShowOnloadWebsitePopup()}$("#onload_website_popup").dialog({closeOnEscape:true,draggable:false,modal:true,resizable:false,classes:{"ui-dialog":"no-titlebar"},position:{my:"center center",at:"center center",of:window,collision:"none"},width:600,title:""});$.cookie("onload_website_popup","true",{expires:60,path:"/"})}function showLoginPopup(){if($("#_login_popup_dialog").length==0){$("body").append('<div class="dialog-box" id="_login_popup_dialog"></div>');$.ajax({url:"/loginform.php?ajax=true&url_action=get_login_form",type:"GET",timeout:(empty(gDefaultAjaxTimeout)?30000:gDefaultAjaxTimeout),success:function(a){var b=processReturn(a);if(b===false){return}$("#_login_popup_dialog").html(b.login_form);showLoginPopup()},error:function(a,c,b){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax")},dataType:"text"});return}$("#_login_popup_dialog #forgot_form").slideUp();$("#_login_popup_dialog #login_form").slideDown();$("#_login_popup_dialog #access_link_div").slideDown();$("#_login_popup_dialog #user_name").focus();$("#_login_popup_dialog").dialog({autoOpen:true,closeOnEscape:true,draggable:true,resizable:true,modal:true,position:{my:"center top",at:"center top+100px",of:window,collision:"none"},width:600,title:"Login",buttons:[{id:"_login_popup_dialog_button",text:"Login",click:function(){const a=$("#_login_popup_dialog").data("forgot_form");if(!empty(a)){if($("#_forgot_form").validationEngine("validate")){$("#_forgot_button").prop("disabled",true);$.ajax({url:"loginform.php?ajax=true&url_action=forgot",type:"POST",data:$("#_forgot_form").serialize(),timeout:30000,success:function(b){var c=processReturn(b);if(c===false){return}if("error_message" in c){$("#_error_message").removeClass("info-message").html(c.error_message);$("#_forgot_button").prop("disabled",false)}else{$("#forgot_form").addClass("info-message");if("info_message" in c){$("#forgot_form").html(c.info_message)}else{$("#forgot_form").html("An email has been sent to the email address on file. Follow the instructions in the email.")}$("#_forgot_button").prop("disabled",false);$("#_login_popup_dialog").data("forgot_form","");setTimeout(function(){$("#_login_popup_dialog").dialog("close")},2000)}},error:function(b,d,c){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax");displayErrorMessage("Unable to process form")},dataType:"text"})}}else{if($("#_login_edit_form").validationEngine("validate")){$.ajax({url:"/loginform.php?ajax=true&url_action=login",type:"POST",data:$("#_login_edit_form").serialize(),cache:false,headers:{"cache-control":"no-cache"},timeout:30000,success:function(b){var c=processReturn(b);if(c===false){return}if("error_message" in c){$("#login_now_button").removeClass("hidden");$("#logging_in_message").html("")}else{location.reload()}},error:function(b,d,c){$("body").removeClass("waiting-for-ajax").removeClass("no-waiting-for-ajax");displayErrorMessage("Login failed...")},dataType:"text"})}}}},{text:"Cancel",click:function(){const a=$("#_login_popup_dialog").data("forgot_form");if(!empty(a)){$("#_login_popup_dialog").data("forgot_form","");if($().validationEngine){$("#_login_edit_form").validationEngine("hideAll")}$("#_login_popup_dialog #forgot_form").slideUp();$("#_login_popup_dialog #login_form").slideDown();$("#_login_popup_dialog #access_link_div").slideDown();$("#_login_popup_dialog #user_name").focus();$("#_login_popup_dialog_button").html("Login");return}$("#_login_popup_dialog").dialog("close")}}]})};